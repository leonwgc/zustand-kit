var R=Object.defineProperty,E=Object.defineProperties;var N=Object.getOwnPropertyDescriptors;var G=Object.getOwnPropertySymbols;var O=Object.prototype.hasOwnProperty,D=Object.prototype.propertyIsEnumerable;var A=(e,t,o)=>t in e?R(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,g=(e,t)=>{for(var o in t||(t={}))O.call(t,o)&&A(e,o,t[o]);if(G)for(var o of G(t))D.call(t,o)&&A(e,o,t[o]);return e},U=(e,t)=>E(e,N(t));import*as x from"react";import{create as w}from"zustand";import{persist as _,createJSONStorage as $,devtools as I}from"zustand/middleware";import{useMemo as b,useRef as j,useCallback as y,useEffect as z}from"react";import{useShallow as m}from"zustand/react/shallow";var s=new Map,c=process.env.NODE_ENV!=="production";function X(e){c=e}var i=null;function C(){return i||(i=w()(I(()=>({}),{name:"GlobalStates (All)"}))),i}function T(e,t){if(i){let o=i.getState();i.setState(U(g({},o),{[e]:t}))}}function Y(){s.clear(),i=null}function k(e,t,o){let{storage:n="none",storageKey:u="global-state"}=o||{};if(!s.has(e)){let f=typeof t=="object"&&t!==null&&!Array.isArray(t),h=(S,K)=>({value:t,setValue:l=>{typeof l=="function"?S(v=>{let p=l(v.value);return c&&T(e,p),{value:p}}):f&&typeof l=="object"&&l!==null?S(v=>{let p=g(g({},v.value),l);return c&&T(e,p),{value:p}}):(S({value:l}),c&&T(e,l))},reset:()=>{S({value:t}),c&&T(e,t)}}),d;if(n!=="none"){let S=n==="localStorage"?localStorage:sessionStorage;d=w()(_(h,{name:`${u}-${e}`,storage:$(()=>S)}))}else d=w(h);s.set(e,d),c&&(C(),T(e,t))}let r=s.get(e),a=r(f=>f.value),V=b(()=>f=>r.getState().setValue(f),[r]),B=b(()=>()=>r.getState().reset(),[r]);return[a,V,B]}function Z(e,t,o){let n=s.get(e);if(!n)throw new Error(`Global state with key "${e}" not found. Initialize it with useGlobalState first.`);let u=j(t);z(()=>{u.current=t});let r=y(a=>u.current(a.value),[]);if(o===void 0){let a=r(n.getState());return a!==null&&typeof a=="object"&&!x.isValidElement(a)?n(m(r)):n(r)}return n(o==="shallow"?m(r):r)}function q(e){let t=s.get(e);if(!t)throw new Error(`Global state with key "${e}" not found. Initialize it with useGlobalState first.`);return b(()=>o=>t.getState().setValue(o),[t])}function ee(e){let t=s.get(e);return t==null?void 0:t.getState().value}function te(e,t){let o=s.get(e);if(!o){process.env.NODE_ENV!=="production"&&console.warn(`Global state with key "${e}" not found. Initialize it with useGlobalState first.`);return}o.getState().setValue(t)}function oe(e,t){let o=s.get(e);if(!o)return process.env.NODE_ENV!=="production"&&console.warn(`Global state with key "${e}" not found. Initialize it with useGlobalState first.`),()=>{};let n=o.getState().value;return o.subscribe(u=>{let r=u.value;Object.is(r,n)||(t(r,n),n=r)})}function re(e){let t=s.get(e);if(!t){process.env.NODE_ENV!=="production"&&console.warn(`Global state with key "${e}" not found. Initialize it with useGlobalState first.`);return}t.getState().reset()}var ne=k;export{Y as __clearAllStates__,X as configureDevtools,ne as default,ee as getGlobalState,re as resetGlobalState,te as setGlobalState,oe as subscribeGlobalState,Z as useGlobalSelector,q as useGlobalSetter,k as useGlobalState};
