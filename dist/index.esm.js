var E=Object.defineProperty;var v=Object.getOwnPropertySymbols;var B=Object.prototype.hasOwnProperty,$=Object.prototype.propertyIsEnumerable;var w=(t,e,o)=>e in t?E(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o,g=(t,e)=>{for(var o in e||(e={}))B.call(e,o)&&w(t,o,e[o]);if(v)for(var o of v(e))$.call(e,o)&&w(t,o,e[o]);return t};import*as U from"react";import{create as f}from"zustand";import{persist as V,createJSONStorage as G,devtools as h}from"zustand/middleware";import{useMemo as d,useRef as R,useCallback as N,useEffect as O}from"react";import{useShallow as m}from"zustand/react/shallow";var n=new Map;function J(){n.clear()}function _(t,e,o){let{storage:r="none",storageKey:i="global-state",enableDevtools:a=process.env.NODE_ENV!=="production"}=o||{};if(!n.has(t)){let u=typeof e=="object"&&e!==null&&!Array.isArray(e),p=l=>({value:e,setValue:S=>{l(typeof S=="function"?T=>({value:S(T.value)}):u&&typeof S=="object"&&S!==null?T=>({value:g(g({},T.value),S)}):{value:S})},reset:()=>l({value:e})}),c;if(r!=="none"&&a){let l=r==="localStorage"?localStorage:sessionStorage;c=f()(h(V(p,{name:`${i}-${t}`,storage:G(()=>l)}),{name:`GlobalState:${t}`}))}else if(r!=="none"){let l=r==="localStorage"?localStorage:sessionStorage;c=f()(V(p,{name:`${i}-${t}`,storage:G(()=>l)}))}else a?c=f()(h(p,{name:`GlobalState:${t}`})):c=f(p);n.set(t,c)}let s=n.get(t),b=s(u=>u.value),A=d(()=>u=>s.getState().setValue(u),[s]),x=d(()=>()=>s.getState().reset(),[s]);return[b,A,x]}function M(t,e,o){let r=n.get(t);if(!r)throw new Error(`Global state with key "${t}" not found. Initialize it with useGlobalState first.`);let i=R(e);O(()=>{i.current=e});let a=N(s=>i.current(s.value),[]);if(o===void 0){let s=a(r.getState());return s!==null&&typeof s=="object"&&!U.isValidElement(s)?r(m(a)):r(a)}return r(o==="shallow"?m(a):a)}function k(t){let e=n.get(t);if(!e)throw new Error(`Global state with key "${t}" not found. Initialize it with useGlobalState first.`);return d(()=>o=>e.getState().setValue(o),[e])}function F(t){let e=n.get(t);return e==null?void 0:e.getState().value}function H(t,e){let o=n.get(t);if(!o){process.env.NODE_ENV!=="production"&&console.warn(`Global state with key "${t}" not found. Initialize it with useGlobalState first.`);return}o.getState().setValue(e)}function L(t,e){let o=n.get(t);if(!o)return process.env.NODE_ENV!=="production"&&console.warn(`Global state with key "${t}" not found. Initialize it with useGlobalState first.`),()=>{};let r=o.getState().value;return o.subscribe(i=>{let a=i.value;Object.is(a,r)||(e(a,r),r=a)})}function Q(t){let e=n.get(t);if(!e){process.env.NODE_ENV!=="production"&&console.warn(`Global state with key "${t}" not found. Initialize it with useGlobalState first.`);return}e.getState().reset()}var W=_;export{J as __clearAllStates__,W as default,F as getGlobalState,Q as resetGlobalState,H as setGlobalState,L as subscribeGlobalState,M as useGlobalSelector,k as useGlobalSetter,_ as useGlobalState};
