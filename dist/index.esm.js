var O=Object.defineProperty,D=Object.defineProperties;var _=Object.getOwnPropertyDescriptors;var G=Object.getOwnPropertySymbols;var j=Object.prototype.hasOwnProperty,N=Object.prototype.propertyIsEnumerable;var m=(e,t,o)=>t in e?O(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,g=(e,t)=>{for(var o in t||(t={}))j.call(t,o)&&m(e,o,t[o]);if(G)for(var o of G(t))N.call(t,o)&&m(e,o,t[o]);return e},B=(e,t)=>D(e,_(t));import*as R from"react";import{create as b}from"zustand";import{persist as $,createJSONStorage as y,devtools as C}from"zustand/middleware";import{useMemo as w,useRef as I,useCallback as z}from"react";import{useShallow as x}from"zustand/react/shallow";var s=new Map,p=process.env.NODE_ENV!=="production";function V(e){process.env.NODE_ENV!=="production"&&console.warn(`Global state with key "${e}" not found. Initialize it with useGlobalState first.`)}function Z(e){p=e}var u=null;function K(){return u||(u=b()(C(()=>({}),{name:"GlobalStates (All)"}))),u}function T(e,t){if(u){let o=u.getState();u.setState(B(g({},o),{[e]:t}))}}function q(){s.clear(),u=null}function M(e,t,o){let{storage:n="none",storageKey:i="global-state"}=o||{};if(!s.has(e)){let S=typeof t=="object"&&t!==null&&!Array.isArray(t),U=(c,P)=>{let h=a=>{c({value:a}),p&&T(e,a)};return{value:t,setValue:a=>{typeof a=="function"?c(v=>{let f=a(v.value);return p&&T(e,f),{value:f}}):S&&typeof a=="object"&&a!==null?c(v=>{let f=g(g({},v.value),a);return p&&T(e,f),{value:f}}):h(a)},reset:()=>{h(t)}}},d;if(n!=="none"){let c=n==="localStorage"?localStorage:sessionStorage;d=b()($(U,{name:`${i}-${e}`,storage:y(()=>c)}))}else d=b(U);s.set(e,d),p&&(K(),T(e,t))}let r=s.get(e),l=r(S=>S.value),A=w(()=>S=>r.getState().setValue(S),[r]),E=w(()=>()=>r.getState().reset(),[r]);return[l,A,E]}function ee(e,t,o){let n=s.get(e);if(!n)throw new Error(`Global state with key "${e}" not found. Initialize it with useGlobalState first.`);let i=I(t);i.current=t;let r=z(l=>i.current(l.value),[]);if(o===void 0){let l=r(n.getState());return l!==null&&typeof l=="object"&&!R.isValidElement(l)?n(x(r)):n(r)}return n(o==="shallow"?x(r):r)}function te(e){let t=s.get(e);if(!t)throw new Error(`Global state with key "${e}" not found. Initialize it with useGlobalState first.`);return w(()=>o=>t.getState().setValue(o),[t])}function oe(e){let t=s.get(e);return t==null?void 0:t.getState().value}function re(e,t){let o=s.get(e);if(!o){V(e);return}o.getState().setValue(t)}function ne(e,t){let o=s.get(e);if(!o)return V(e),()=>{};let n=o.getState().value;return o.subscribe(i=>{let r=i.value;Object.is(r,n)||(t(r,n),n=r)})}function se(e){let t=s.get(e);if(!t){V(e);return}t.getState().reset()}var ae=M;export{q as __clearAllStates__,Z as configureDevtools,ae as default,oe as getGlobalState,se as resetGlobalState,re as setGlobalState,ne as subscribeGlobalState,ee as useGlobalSelector,te as useGlobalSetter,M as useGlobalState};
