var x=Object.defineProperty,E=Object.defineProperties;var N=Object.getOwnPropertyDescriptors;var h=Object.getOwnPropertySymbols;var O=Object.prototype.hasOwnProperty,D=Object.prototype.propertyIsEnumerable;var G=(t,e,o)=>e in t?x(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o,T=(t,e)=>{for(var o in e||(e={}))O.call(e,o)&&G(t,o,e[o]);if(h)for(var o of h(e))D.call(e,o)&&G(t,o,e[o]);return t},A=(t,e)=>E(t,N(e));import*as m from"react";import{create as v}from"zustand";import{persist as _,createJSONStorage as $,devtools as I}from"zustand/middleware";import{useMemo as w,useRef as j,useCallback as y,useEffect as z}from"react";import{useShallow as U}from"zustand/react/shallow";var a=new Map,i=null;function C(){return i||(i=v()(I(()=>({}),{name:"GlobalStates (All)"}))),i}function p(t,e){if(i){let o=i.getState();i.setState(A(T({},o),{[t]:e}))}}function X(){a.clear(),i=null}function k(t,e,o){let{storage:n="none",storageKey:u="global-state",enableDevtools:r=process.env.NODE_ENV!=="production"}=o||{};if(!a.has(t)){let c=typeof e=="object"&&e!==null&&!Array.isArray(e),V=(S,K)=>({value:e,setValue:l=>{typeof l=="function"?S(d=>{let f=l(d.value);return r&&p(t,f),{value:f}}):c&&typeof l=="object"&&l!==null?S(d=>{let f=T(T({},d.value),l);return r&&p(t,f),{value:f}}):(S({value:l}),r&&p(t,l))},reset:()=>{S({value:e}),r&&p(t,e)}}),g;if(n!=="none"){let S=n==="localStorage"?localStorage:sessionStorage;g=v()(_(V,{name:`${u}-${t}`,storage:$(()=>S)}))}else g=v(V);a.set(t,g),r&&(C(),p(t,e))}let s=a.get(t),b=s(c=>c.value),B=w(()=>c=>s.getState().setValue(c),[s]),R=w(()=>()=>s.getState().reset(),[s]);return[b,B,R]}function Y(t,e,o){let n=a.get(t);if(!n)throw new Error(`Global state with key "${t}" not found. Initialize it with useGlobalState first.`);let u=j(e);z(()=>{u.current=e});let r=y(s=>u.current(s.value),[]);if(o===void 0){let s=r(n.getState());return s!==null&&typeof s=="object"&&!m.isValidElement(s)?n(U(r)):n(r)}return n(o==="shallow"?U(r):r)}function Z(t){let e=a.get(t);if(!e)throw new Error(`Global state with key "${t}" not found. Initialize it with useGlobalState first.`);return w(()=>o=>e.getState().setValue(o),[e])}function q(t){let e=a.get(t);return e==null?void 0:e.getState().value}function ee(t,e){let o=a.get(t);if(!o){process.env.NODE_ENV!=="production"&&console.warn(`Global state with key "${t}" not found. Initialize it with useGlobalState first.`);return}o.getState().setValue(e)}function te(t,e){let o=a.get(t);if(!o)return process.env.NODE_ENV!=="production"&&console.warn(`Global state with key "${t}" not found. Initialize it with useGlobalState first.`),()=>{};let n=o.getState().value;return o.subscribe(u=>{let r=u.value;Object.is(r,n)||(e(r,n),n=r)})}function oe(t){let e=a.get(t);if(!e){process.env.NODE_ENV!=="production"&&console.warn(`Global state with key "${t}" not found. Initialize it with useGlobalState first.`);return}e.getState().reset()}var re=k;export{X as __clearAllStates__,re as default,q as getGlobalState,oe as resetGlobalState,ee as setGlobalState,te as subscribeGlobalState,Y as useGlobalSelector,Z as useGlobalSetter,k as useGlobalState};
